"use strict";var e,r=(e=require("node-fetch"))&&"object"==typeof e&&"default"in e?e.default:e;function s(e,r,t){var o;for(o in e)o===r?e[r]=t(e[r]):"object"==typeof e[o]&&s(e[o],r,t)}class t{constructor(e,r,s){s&&(this._source=s),this._options={production:e},r&&Object.assign(this._options,{preview:r})}_process(e,r){return e=JSON.parse(e),r.preprocess?("content"===r.preprocess[0]&&(Array.isArray(e)?e.map(e=>{e.content&&s(e,"content",r.preprocess[1])}):s(e,"content",r.preprocess[1])),"item"===r.preprocess[0]&&(Array.isArray(e)?e.map(e=>r.preprocess[1](e)):e=r.preprocess[1](e)),"collection"===r.preprocess[0]&&Array.isArray(e)&&(e=r.preprocess[1](e)),e):e}get(e){var s=this._options;return(process.browser?window.fetch:r)(`${"development"===process.env.NODE_ENV?s.preview&&"undefined"!==this._source?s.preview:s.production:s.production?s.production:s.preview}${e}`).then(e=>e.text()).then(e=>{try{return this._process(e,s)}catch(r){return e}})}preprocess(e,r){Object.assign(this._options,{preprocess:[e,r]})}}module.exports=function(e){return new class{constructor(e){e&&(this._source=e)}client(e){return new t(e,"http://localhost:4000/",this._source)}}(e)};
